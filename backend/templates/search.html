{% extends 'base.html' %}
{% load mathfilters %}
{% load static %}
{% block content %}
<main class="page">
			<section class="search">
				<div class="search__container">
					<form action="{% url 'search' %}" class="search-form form" method="GET">
						<div class="search-form__column search-form__column_1">
							<div class="search-form__item">
								<label for="search-link" class="label-black">Ссылка:</label>
								<input type="text" id="search-link" name="chanel_link" placeholder="https://telemetr.me/channels/" class="form__input" value="{{ request.GET.chanel_link }}">
							</div>
							<div class="search-form__item">
								<label for="search-name" class="label-black">Название канала:</label>
								<input type="text" id="search-name" name="chanel_name" placeholder="взлом маркетинга" class="form__input" value="{{ request.GET.chanel_name }}">
							</div>
							<div class="search-form__item">
								<label for="search-desc" class="label-black">Описание:</label>
								<input type="text" id="search-desc" name="description" placeholder="маркетинг" class="form__input" value="{{ request.GET.description }}">
							</div>
						</div>
						<div class="search-form__column search-form__column_2">
							<div class="search-form__item">
								<label for="form-subs-from" class="label-black">Подписчиков:</label>
								<div class="search-form__item-content">
									<label for="orm-subs-from" class="label-black">От</label>
									<input type="number" id="form-subs-from" name="subscribers_from" placeholder="1000" class="form__input" value="{{ request.GET.subscribers_from }}">
									<label for="form-subs-to" class="label-black">До</label>
									<input type="number" id="form-subs-to" name="subscribers_to" placeholder="1000" class="form__input" value="{{ request.GET.subscribers_to }}">
								</div>
							</div>
							<div class="search-form__item">
								<label for="post-visible-from" class="label-black">Просмотров на пост:</label>
								<div class="search-form__item-content">
									<label for="post-visible-from" class="label-black">От</label>
									<input type="number" id="post-visible-from" name="views_from" placeholder="1000" class="form__input" value="{{ request.GET.views_from }}">
									<label for="post-visible-from-to" class="label-black">До</label>
									<input type="number" id="post-visible-from-to" name="views_to" placeholder="1000" class="form__input" value="{{ request.GET.views_to }}">
								</div>
							</div>
							<div class="search-form__item">
								<label for="repost-week-from" class="label-black">Упоминаний за неделю:</label>
								<div class="search-form__item-content">
									<label for="repost-week-from" class="label-black">От</label>
									<input type="number" id="repost-week-from" name="mention_from" placeholder="1000" class="form__input" value="{{ request.GET.mention_from }}">
									<label for="repost-week-to" class="label-black">До</label>
									<input type="number" id="repost-week-to" name="mention_to" placeholder="1000" class="form__input" value="{{request.GET.mention_to}}">
								</div>
							</div>
						</div>
						<div data-da=".search-form__column_1,992.98" class="search-form__column">
							<div class="search-form__item search-form__item_select">
								<label for="channel-type" class="label-black">Тип канала:</label>
								<div class="search-form__item-content">
									<select name="channel-type" id="channel-type" data-class-modif="custom-select">
										<option value="1" selected>Не важно</option>
										<option value="2">Не важно 1</option>
										<option value="3">Не важно 2</option>
										<option value="4">Не важно 3</option>
									</select>
									<select name="channel-type" id="channel-type" data-class-modif="custom-select">
										<option value="1" selected>Категории</option>
										<option value="2">Категории 1</option>
										<option value="3">Категории 2</option>
										<option value="4">Категории 3</option>
									</select>
								</div>
							</div>

							<div data-da=".search-form__column_2,992.98" class="search-form__item search-form__item_center">
								<label for="er-from" class="label-black search-form__label">ER:</label>
								<div class="search-form__item-content search-form__item-content_center">
									<label for="er-from" class="label-black">От</label>
									<input type="number" id="er-from" name="er-from" placeholder="100" class="form__input">
									<label for="er-to" class="label-black">До</label>
									<input type="number" id="er-to" name="er-to" placeholder="1000" class="form__input">
								</div>
							</div>
						</div>
						<div data-da=".search-form__column_2,992.98" class="search-form__column search-form__column_btn">
							<button class="button" type="submit">Найти каналы</button>
						</div>
					</form>
				</div>
			</section>
			<section class="search-channels">
				<div class="search-channels__container">
					<div class="search-channels__head">
						<div class="search-channels__tabs-head">
							<div class="search-channels__nums tabs-navigation">
								  {% for p in page_obj.paginator.page_range %}


								 	{% if page_obj.number == p %}
									<a href="?page={{ p }}">
									<button class="search-channels__num tabs-navigation__title _tab-active" type="button">{{p}}</button>
									</a>
										{% else %}
								<a href="?page={{ p }}">
									<button class="search-channels__num tabs-navigation__title" type="button">{{ p }}</button>
									</a>
									{% endif %}
									{% endfor %}
							</div>


							<div class="search-channels__head-text">
								Найдено <span>{{lists}}</span> каналов
							</div>
						</div>
					</div>
					<div class="analitics-tabs__table-wrap-container analitics-tabs__table-wrap-container_auto">
						<table class="table search-channels__table">
							<thead>
								<tr>
									<th scope="col">
										<div class="label-black">Название</div>
									</th>
									<th scope="col">
										<div class="label-black">Подписчики</div>
									</th>
									<th scope="col">
										<div data-dropdown class="header__dropdown dropdown-header dropdown-header-lang">
											<button data-dropdown-btn class="dropdown-header__btn" type="button">
												<img src="{% static 'img/icons/users-filling-black.svg' %}" alt="">
												<span>Сегодня</span>
												<img src="{% static 'img/icons/arrow-down.svg' %}" class="arrow" alt="">
											</button>
											<div class="dropdown-header-lang__list dropdown-header__list dropdown-header__list_lang">
												<a href="#" class="dropdown-header-lang__item">Сегодня 1</a>
												<a href="#" class="dropdown-header-lang__item">Сегодня 2</a>
											</div>
										</div>
									</th>
									<th scope="col">
										<div data-dropdown class="header__dropdown dropdown-header dropdown-header-lang">
											<button data-dropdown-btn class="dropdown-header__btn" type="button">
												<img src="{% static 'img/icons/eye_black.svg' %}" alt="">
												<span>На пост/вчера</span>
												<img src="{% static 'img/icons/arrow-down.svg' %}" class="arrow" alt="">
											</button>
											<div class="dropdown-header-lang__list dropdown-header__list dropdown-header__list_lang">
												<a href="#" class="dropdown-header-lang__item">На пост/вчера 1</a>
												<a href="#" class="dropdown-header-lang__item">На пост/вчера 2</a>
											</div>
										</div>
									</th>
									<th>
										<div class="label-black">ER</div>
									</th>
									<th>

									</th>
								</tr>
							</thead>
							<tbody>
							{% for item in object_list  %}

							{% with last_cost_format=item.add_chanel.cost_formats.last %}
							{% with er=item.views|div:item.subscribers|mul:100 %}


								<tr>
									<td scope="row">
										<div class="channel-tabs-channels__head">
											<a href="#" target="_blank" class="channel-tabs-channels__img">
												<picture><source srcset="/{{item.pictures}}" type="image/webp"><img class="img-fluid" src="/{{item.pictures}}" alt=""></picture>
											</a>
											<div class="channel-tabs-channels__content">
												<div class="channel-tabs-channels__content">

													<div class="channel-tabs-channels__title title">
													<a href="{{item.chanel_link}}" class="img">{{item.name}}</a>
														<img id="copyButton" src="{% static 'img/icons/copy.svg' %}" alt="" >
														</div>




													<div class="channel-count label-blue label-blue_s20">


														<span>
															<img src="{% static 'img/icons/users-filling.svg' %}" alt="">
															{{item.subscribers}}
														</span>
														<div class="channel-count__btns">
															<button class="channel-count__btn" type="button">
																<img class="img-fluid" src="{% static 'img/analitics/posts_blue.svg' %}" alt="">
															</button>
															<button class="channel-count__btn" type="button">
																<img class="img-fluid" src="{% static 'img/icons/note.svg' %}" alt="">
															</button>
															<button class="channel-count__btn" id="like" type="button">
																<img class="img-fluid not-fill" src="{% static 'img/icons/like.svg' %}" alt="">
																<img class="img-fluid fill" src="{% static 'img/icons/like-fill.svg' %}" alt="">
															</button>
														</div>
													</div>
												</div>
											</div>
										</div>
									</td>
									<td>
										<div class="label-blue label-blue_s24">{{item.subscribers}}</div>
									</td>
									<td>
										<div class="label-green label-green_s24">+129</div>
									</td>
									<td>
										<div class="label-blue label-blue_s24">{{item.views}}</div>
									</td>
									<td>
										<div class="label-blue label-blue_s24">{{er|floatformat:2 }}%</div>
									</td>
									<td>
										<div class="search-channels__btns">
											<button class="button button_no-bg" type="button">Описание</button>
											<button class="button button_no-bg" type="button" data-popup="#popup-content">Контент</button>
											<button class="button" type="button">Анализ</button>
										</div>
									</td>
								</tr>
							{% endwith %}
                			{% endwith %}



                			{% endfor %}

							</tbody>
						</table>
					</div>
					<div class="channels-tabs__bottom">
						<div class="search-channels__nums tabs-navigation">
							{% for p in page_obj.paginator.page_range %}


								 	{% if page_obj.number == p %}
									<a href="?page={{ p }}">
									<button class="search-channels__num tabs-navigation__title _tab-active" type="button">{{p}}</button>
									</a>
										{% else %}
								<a href="?page={{ p }}">
									<button class="search-channels__num tabs-navigation__title" type="button">{{ p }}</button>
									</a>
									{% endif %}
									{% endfor %}
						</div>
						<div class="channels-tabs__arrows">
							{% if page_obj.has_previous %}
							<a href="?page={{page_obj.previous_page_number}}">
							<button class="channels-tabs__arrow channels-tabs__arrow_left" type="button">
								<img class="img-fluid" src="{% static 'img/icons/arrow-down.svg' %}" alt="">
							</button></a>
							{% else %}
							<a href="?page={{page_obj.number}}">
							<button class="channels-tabs__arrow channels-tabs__arrow_left" type="button">
								<img class="img-fluid" src="{% static 'img/icons/arrow-down.svg' %}" alt="">
							</button></a>
							{% endif %}
							 {% if page_obj.has_next %}
							<a href="?page={{ page_obj.next_page_number }}">
							<button class="channels-tabs__arrow channels-tabs__arrow_right" type="button">
								<img class="img-fluid" src="{% static 'img/icons/arrow-down.svg' %}" alt="">
							</button></a>
							{% else %}
							<a href="?page={{page_obj.number}}">
							<button class="channels-tabs__arrow channels-tabs__arrow_right" type="button">
								<img class="img-fluid" src="{% static 'img/icons/arrow-down.svg' %}" alt="">
							</button></a>
							{% endif %}

						</div>
					</div>
				</div>
			</section>
		</main>

<script>
		$(document).ready(function () {
    	$('#copyButton').click(function() {
        var channelLink = $('.img').attr('href');
        var tempInput = $('<input>');
        $('body').append(tempInput);
        tempInput.val(channelLink).select();
        document.execCommand('copy');
        tempInput.remove();
        alert('Посилання скопійоване в буфер обміну!');
   });
   });
</script>
{% endblock %}